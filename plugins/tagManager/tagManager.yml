name: Tag Manager
description: Match and sync local tags with stash-box endpoints. Features multi-endpoint support, tag caching, layered search (exact, fuzzy, synonym), and field-by-field merge dialog.
version: 0.3.0
url: https://github.com/carrotwaxr/stash-plugins

ui:
  javascript:
    - tag-manager.js
  css:
    - tag-manager.css

settings:
  enableFuzzySearch:
    displayName: Enable Fuzzy Search
    description: Use fuzzy matching for close variations (typos, etc). Enabled by default.
    type: BOOLEAN
  enableSynonymSearch:
    displayName: Enable Synonym Search
    description: Use custom synonym mappings. Enabled by default.
    type: BOOLEAN
  fuzzyThreshold:
    displayName: Fuzzy Match Threshold
    description: Minimum score (0-100) for fuzzy matches. Default is 80.
    type: NUMBER
  pageSize:
    displayName: Tags Per Page
    description: Number of tags to show per page. Default is 25.
    type: NUMBER
  syncDryRun:
    displayName: Scene Tag Sync - Dry Run
    description: Preview what tags would be added without making changes (caps at 200 scenes). Default is enabled for safety.
    type: BOOLEAN
  categoryMappings:
    displayName: Category Mappings (Internal)
    description: JSON mapping of StashDB categories to local parent tag IDs. Managed automatically.
    type: STRING
  tagBlacklist:
    displayName: Tag Blacklist
    description: Tags to exclude from matching and sync. One pattern per line. Prefix with / for regex (e.g., /Available$/).
    type: STRING

exec:
  - python
  - "{pluginDir}/tag_manager.py"
interface: raw

tasks:
  - name: Sync Scene Tags from StashDB
    description: Fetch tags from StashDB for all scenes with StashIDs and merge with local tags
    defaultArgs:
      mode: sync_scene_tags
